// ██╗██╗███╗░░░███╗██╗░░░██╗  ███╗░░██╗░█████╗░███╗░░░███╗███████╗  ██╗░██████╗
// ╚█║╚█║████╗░████║╚██╗░██╔╝  ████╗░██║██╔══██╗████╗░████║██╔════╝  ██║██╔════╝
// ░╚╝░╚╝██╔████╔██║░╚████╔╝░  ██╔██╗██║███████║██╔████╔██║█████╗░░  ██║╚█████╗░
// ░░░░░░██║╚██╔╝██║░░╚██╔╝░░  ██║╚████║██╔══██║██║╚██╔╝██║██╔══╝░░  ██║░╚═══██╗
// ░░░░░░██║░╚═╝░██║░░░██║░░░  ██║░╚███║██║░░██║██║░╚═╝░██║███████╗  ██║██████╔╝
// ░░░░░░╚═╝░░░░░╚═╝░░░╚═╝░░░  ╚═╝░░╚══╝╚═╝░░╚═╝╚═╝░░░░░╚═╝╚══════╝  ╚═╝╚═════╝░

// ░██████╗██╗░░██╗░█████╗░██████╗░░█████╗░░██╗░░░░░░░██╗██╗  ██╗░░██╗███████╗  ░██╗░░░░░░░██╗██╗░░██╗░█████╗░
// ██╔════╝██║░░██║██╔══██╗██╔══██╗██╔══██╗░██║░░██╗░░██║╚═╝  ██║░░██║██╔════╝  ░██║░░██╗░░██║██║░░██║██╔══██╗
// ╚█████╗░███████║███████║██║░░██║██║░░██║░╚██╗████╗██╔╝░░░  ███████║█████╗░░  ░╚██╗████╗██╔╝███████║██║░░██║
// ░╚═══██╗██╔══██║██╔══██║██║░░██║██║░░██║░░████╔═████║░░░░  ██╔══██║██╔══╝░░  ░░████╔═████║░██╔══██║██║░░██║
// ██████╔╝██║░░██║██║░░██║██████╔╝╚█████╔╝░░╚██╔╝░╚██╔╝░██╗  ██║░░██║███████╗  ░░╚██╔╝░╚██╔╝░██║░░██║╚█████╔╝
// ╚═════╝░╚═╝░░╚═╝╚═╝░░╚═╝╚═════╝░░╚════╝░░░░╚═╝░░░╚═╝░░╚═╝  ╚═╝░░╚═╝╚══════╝  ░░░╚═╝░░░╚═╝░░╚═╝░░╚═╝░╚════╝░

// ██╗░░░░░██╗░░░██╗██████╗░██╗░░██╗░██████╗  ██╗███╗░░██╗  ████████╗██╗░░██╗███████╗
// ██║░░░░░██║░░░██║██╔══██╗██║░██╔╝██╔════╝  ██║████╗░██║  ╚══██╔══╝██║░░██║██╔════╝
// ██║░░░░░██║░░░██║██████╔╝█████═╝░╚█████╗░  ██║██╔██╗██║  ░░░██║░░░███████║█████╗░░
// ██║░░░░░██║░░░██║██╔══██╗██╔═██╗░░╚═══██╗  ██║██║╚████║  ░░░██║░░░██╔══██║██╔══╝░░
// ███████╗╚██████╔╝██║░░██║██║░╚██╗██████╔╝  ██║██║░╚███║  ░░░██║░░░██║░░██║███████╗
// ╚══════╝░╚═════╝░╚═╝░░╚═╝╚═╝░░╚═╝╚═════╝░  ╚═╝╚═╝░░╚══╝  ░░░╚═╝░░░╚═╝░░╚═╝╚══════╝

// ░██████╗██╗░░██╗░█████╗░██████╗░░█████╗░░██╗░░░░░░░██╗░██████╗  ████████╗░█████╗░  ██╗░░██╗██╗░░░██╗███╗░░██╗████████╗
// ██╔════╝██║░░██║██╔══██╗██╔══██╗██╔══██╗░██║░░██╗░░██║██╔════╝  ╚══██╔══╝██╔══██╗  ██║░░██║██║░░░██║████╗░██║╚══██╔══╝
// ╚█████╗░███████║███████║██║░░██║██║░░██║░╚██╗████╗██╔╝╚█████╗░  ░░░██║░░░██║░░██║  ███████║██║░░░██║██╔██╗██║░░░██║░░░
// ░╚═══██╗██╔══██║██╔══██║██║░░██║██║░░██║░░████╔═████║░░╚═══██╗  ░░░██║░░░██║░░██║  ██╔══██║██║░░░██║██║╚████║░░░██║░░░
// ██████╔╝██║░░██║██║░░██║██████╔╝╚█████╔╝░░╚██╔╝░╚██╔╝░██████╔╝  ░░░██║░░░╚█████╔╝  ██║░░██║╚██████╔╝██║░╚███║░░░██║░░░
// ╚═════╝░╚═╝░░╚═╝╚═╝░░╚═╝╚═════╝░░╚════╝░░░░╚═╝░░░╚═╝░░╚═════╝░  ░░░╚═╝░░░░╚════╝░  ╚═╝░░╚═╝░╚═════╝░╚═╝░░╚══╝░░░╚═╝░░░

// ████████╗██╗░░██╗███████╗  ░██████╗██╗░░██╗░█████╗░██████╗░░█████╗░░██╗░░░░░░░██╗░██████╗░░░██╗██╗
// ╚══██╔══╝██║░░██║██╔════╝  ██╔════╝██║░░██║██╔══██╗██╔══██╗██╔══██╗░██║░░██╗░░██║██╔════╝░░░╚█║╚█║
// ░░░██║░░░███████║█████╗░░  ╚█████╗░███████║███████║██║░░██║██║░░██║░╚██╗████╗██╔╝╚█████╗░░░░░╚╝░╚╝
// ░░░██║░░░██╔══██║██╔══╝░░  ░╚═══██╗██╔══██║██╔══██║██║░░██║██║░░██║░░████╔═████║░░╚═══██╗░░░░░░░░░
// ░░░██║░░░██║░░██║███████╗  ██████╔╝██║░░██║██║░░██║██████╔╝╚█████╔╝░░╚██╔╝░╚██╔╝░██████╔╝██╗░░░░░░
// ░░░╚═╝░░░╚═╝░░╚═╝╚══════╝  ╚═════╝░╚═╝░░╚═╝╚═╝░░╚═╝╚═════╝░░╚════╝░░░░╚═╝░░░╚═╝░░╚═════╝░╚═╝░░░░░░




#include <bits/stdc++.h>
using namespace std;
#define gc getchar_unlocked
#define fo(i, n) for (i = 0; i < n; i++)
#define Fo(i, k, n) for (i = k; k < n ? i < n : i > n; k < n ? i += 1 : i -= 1)
#define ll long long
#define deb(x) cout << #x << "=" << x << endl
#define pb push_back
#define mp make_pair
#define F first
#define S second
#define all(x) x.begin(), x.end()
#define clr(x) memset(x, false, sizeof(x))
#define sortall(x) sort(all(x))
#define tr(it, a) for (auto it = a.begin(); it != a.end(); it++)
#define PI 3.1415926535897932384626
#define mod 1000000007
typedef pair<int, int> pii;
typedef pair<ll, ll> pl;
typedef vector<int> vi;
typedef vector<ll> vl;
typedef vector<pii> vpii;
typedef vector<pl> vpl;
typedef vector<vi> vvi;
typedef vector<vl> vvl;
void file_i_o(){
    ios_base::sync_with_stdio(0);
    cin.tie(0);
    cout.tie(0);
}
bool issafe(int i,int j,int h,int w){
    return i >= 0 && i < h && j >= 0 && j < w;
}
vector<vector<int>> dir = {
    {0, 1},   // right
    {1, 0},   // down
    {0, -1},  // left
    {-1, 0}   // up
};
int main(){
    ios::sync_with_stdio(false);
    cin.tie(nullptr);

    int h,w; cin>>h>>w;
    vector<vector<char>> v(h,vector<char>(w));
    int sx=-1,sy=-1,gx=-1,gy=-1;
    for(int i=0;i<h;i++){
        for(int j=0;j<w;j++){
            cin>>v[i][j];
            if(v[i][j]=='S'){ sx=i; sy=j; }
            if(v[i][j]=='G'){ gx=i; gy=j; }
        }
    }

    vector<vector<array<bool,2>>> visited(h, vector<array<bool,2>>(w, {false,false}));
    queue<tuple<int,int,int>> que;
    que.emplace(sx,sy,0);
    visited[sx][sy][0] = true;

    int ans = 0;
    while(!que.empty()){
        int sz = que.size();
        while(sz--){
            auto t = que.front(); que.pop();
            int x = get<0>(t);
            int y = get<1>(t);
            int p = get<2>(t);

            if(x==gx && y==gy){
                cout<<ans<<endl;
                return 0;
            }

            for(auto &d: dir){
                int nx = x + d[0];
                int ny = y + d[1];
                if(!issafe(nx,ny,h,w)) continue;
                char c = v[nx][ny];
                if(c == '#') continue;

                if((c=='x' && p==0) || (c=='o' && p==1)) continue;
                int np = p ^ (c == '?'); 
                if(!visited[nx][ny][np]){
                    visited[nx][ny][np] = true;
                    que.emplace(nx,ny,np);
                }
            }
        }
        ans++;
    }

    cout<<-1<<endl;
    return 0;
}